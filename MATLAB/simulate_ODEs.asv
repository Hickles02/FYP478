function dxdt = simulate_ODEs(t, x, u, p)
% This fucntion simulates the molar holdup ODEs
        
    MM = x(1:p.N+1);
    
    v  = intermediaries(t, MM, u, p);
    
    ddt_MM = zeros(p.N+1, 1);
    for n = 1:(p.N -1
        ddt_MM(n) = v.L(n+1) - v.L(n) - u.Q{n}(t);
    end

    ddt_MM(2) = ddt_MM(2) + u.LF(t);
    ddt_MM(4) = u.LR(t) - v.L(4) - u.Q(4);
    ddt_MM(5) = v.L(1) - v.LB - u.Freb(t);
  
    dxdt = ddt_MM;

end